# -*- coding: utf-8 -*-
"""
==============================================================================
FLASK –ü–†–ò–õ–û–ñ–ï–ù–ò–ï –î–õ–Ø –ü–†–ï–ú–ò–£–ú –†–ï–°–¢–û–†–ê–ù–ù–û–ì–û –°–ê–ô–¢–ê
==============================================================================
–ê–≤—Ç–æ—Ä: Senior Full Stack Developer
–û–ø–∏—Å–∞–Ω–∏–µ: MVP –æ–¥–Ω–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω–æ–≥–æ —Å–∞–π—Ç–∞ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞ —Å po—ç–∫—Ä–∞–Ω–Ω–æ–π –ø—Ä–æ–∫—Ä—É—Ç–∫–æ–π
==============================================================================
"""

# ==============================================================================
# –ò–ú–ü–û–†–¢ –ë–ò–ë–õ–ò–û–¢–ï–ö
# ==============================================================================
import os
from flask import Flask, render_template
from dotenv import load_dotenv

# ==============================================================================
# –ó–ê–ì–†–£–ó–ö–ê –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò –ò–ó .env –§–ê–ô–õ–ê
# ==============================================================================
# load_dotenv() –∏—â–µ—Ç —Ñ–∞–π–ª .env –≤ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
# –æ–∫—Ä—É–∂–µ–Ω–∏—è. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–Ω–µ –∫–æ–¥–∞.
load_dotenv()


# ==============================================================================
# –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø FLASK –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø
# ==============================================================================
app = Flask(__name__)

# –ü–æ–ª—É—á–∞–µ–º SECRET_KEY –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è
# –ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback
# –í–ê–ñ–ù–û: –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –í–°–ï–ì–î–ê —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ SECRET_KEY —á–µ—Ä–µ–∑ .env!
secret_key = os.getenv('SECRET_KEY')
if not secret_key:
    # –ï—Å–ª–∏ –∫–ª—é—á –Ω–µ –Ω–∞–π–¥–µ–Ω, –≤—ã–≤–æ–¥–∏–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≤ –∫–æ–Ω—Å–æ–ª—å
    print("‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: SECRET_KEY –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ .env —Ñ–∞–π–ª–µ!")
    print("‚ö†Ô∏è  –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∫–ª—é—á –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.")
    print("‚ö†Ô∏è  –°–∫–æ–ø–∏—Ä—É–π—Ç–µ .env.example –≤ .env –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á.")
    secret_key = 'unsafe-default-key-change-in-production'

app.config['SECRET_KEY'] = secret_key

# –†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏ (Debug mode)
# –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å False
app.config['DEBUG'] = os.getenv('FLASK_DEBUG', 'False').lower() == 'true'


# ==============================================================================
# –ú–ê–†–®–†–£–¢–´ (ROUTES)
# ==============================================================================

@app.route('/')
def index():
    """
    –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–∞–π—Ç–∞.
    
    –†–µ–Ω–¥–µ—Ä–∏—Ç —à–∞–±–ª–æ–Ω index.html —Å –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è —Å–µ–∫—Ü–∏–π:
    - Hero (–≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω —Å –≤–∏–¥–µ–æ)
    - –û –Ω–∞—Å
    - –ú–µ–Ω—é
    - –ö–æ–Ω—Ç–∞–∫—Ç—ã
    """
    # –î–∞–Ω–Ω—ã–µ –¥–ª—è —Å–µ–∫—Ü–∏–∏ "–ú–µ–Ω—é" - –∫–∞—Ä—Ç–æ—á–∫–∏ –±–ª—é–¥ –¥–ª—è —Å–ª–∞–π–¥–µ—Ä–∞ Swiper
    menu_items = [
        {
            'name': '–°—Ç–µ–π–∫ –†–∏–±–∞–π',
            'description': '–ú—Ä–∞–º–æ—Ä–Ω–∞—è –≥–æ–≤—è–¥–∏–Ω–∞, –≥—Ä–∏–ª—å –æ–≤–æ—â–∏, —Å–æ—É—Å –¥–µ–º–∏–≥–ª–∞—Å',
            'price': '2 800 ‚ÇΩ',
            'image': 'dish1.jpg'
        },
        {
            'name': '–¢–∞—Ä-—Ç–∞—Ä –∏–∑ —Ç—É–Ω—Ü–∞',
            'description': '–°–≤–µ–∂–∏–π —Ç—É–Ω–µ—Ü, –∞–≤–æ–∫–∞–¥–æ, —Å–æ–µ–≤—ã–π —Å–æ—É—Å, –∫—É–Ω–∂—É—Ç',
            'price': '1 450 ‚ÇΩ',
            'image': 'dish2.jpg'
        },
        {
            'name': '–†–∏–∑–æ—Ç—Ç–æ —Å —Ç—Ä—é—Ñ–µ–ª–µ–º',
            'description': '–°–ª–∏–≤–æ—á–Ω—ã–π —Ä–∏—Å –∞—Ä–±–æ—Ä–∏–æ, —á—ë—Ä–Ω—ã–π —Ç—Ä—é—Ñ–µ–ª—å, –ø–∞—Ä–º–µ–∑–∞–Ω',
            'price': '1 850 ‚ÇΩ',
            'image': 'dish3.jpg'
        },
        {
            'name': '–õ–æ—Å–æ—Å—å –Ω–∞ –≥—Ä–∏–ª–µ',
            'description': '–§–∏–ª–µ –ª–æ—Å–æ—Å—è, —Å–ø–∞—Ä–∂–∞, –ª–∏–º–æ–Ω–Ω—ã–π —Å–æ—É—Å',
            'price': '2 200 ‚ÇΩ',
            'image': 'dish4.jpg'
        },
        {
            'name': '–£—Ç–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞',
            'description': '–£—Ç–∫–∞ –∫–æ–Ω—Ñ–∏, –≤–∏—à–Ω—ë–≤—ã–π —Å–æ—É—Å, –∫–∞—Ä—Ç–æ—Ñ–µ–ª—å –¥–æ—Ñ–∏–Ω—É–∞',
            'price': '2 400 ‚ÇΩ',
            'image': 'dish5.jpg'
        },
        {
            'name': '–¢–∏—Ä–∞–º–∏—Å—É',
            'description': '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –∏—Ç–∞–ª—å—è–Ω—Å–∫–∏–π –¥–µ—Å–µ—Ä—Ç —Å –º–∞—Å–∫–∞—Ä–ø–æ–Ω–µ',
            'price': '650 ‚ÇΩ',
            'image': 'dish6.jpg'
        }
    ]
    
    # –ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞
    contacts = {
        'address': '–ú–æ—Å–∫–≤–∞, —É–ª. –ü—Ä–µ—á–∏—Å—Ç–µ–Ω–∫–∞, 12',
        'phone': '+7 (495) 123-45-67',
        'email': 'info@restaurant.ru',
        'hours': '–ü–Ω-–í—Å: 12:00 - 00:00'
    }
    
    return render_template('index.html', menu_items=menu_items, contacts=contacts)


# ==============================================================================
# –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –û–®–ò–ë–û–ö
# ==============================================================================

@app.errorhandler(404)
def page_not_found(error):
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–∫–∏ 404 (—Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞).
    
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–∞—Å—Ç–æ–º–Ω—ã–π —à–∞–±–ª–æ–Ω 404.html –≤–º–µ—Å—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã Flask.
    –í—Ç–æ—Ä–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä (404) - HTTP —Å—Ç–∞—Ç—É—Å-–∫–æ–¥ –æ—Ç–≤–µ—Ç–∞.
    """
    return render_template('404.html'), 404


@app.errorhandler(500)
def internal_server_error(error):
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–∫–∏ 500 (–≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞).
    
    –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –≤–∞–∂–Ω–æ –ù–ï –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
    """
    return render_template('404.html', 
                          error_code=500, 
                          error_message='–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞'), 500


# ==============================================================================
# –ó–ê–ü–£–°–ö –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø
# ==============================================================================
if __name__ == '__main__':
    # –ü–æ–ª—É—á–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ö–æ—Å—Ç–∞ –∏ –ø–æ—Ä—Ç–∞ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
    host = os.getenv('FLASK_HOST', '127.0.0.1')
    port = int(os.getenv('FLASK_PORT', 5000))
    debug = os.getenv('FLASK_DEBUG', 'False').lower() == 'true'
    
    print("=" * 60)
    print("üçΩÔ∏è  –ó–ê–ü–£–°–ö –°–ï–†–í–ï–†–ê –†–ï–°–¢–û–†–ê–ù–ù–û–ì–û –°–ê–ô–¢–ê")
    print("=" * 60)
    print(f"üìç –ê–¥—Ä–µ—Å: http://{host}:{port}")
    print(f"üêõ –†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏: {'–í–∫–ª—é—á–µ–Ω' if debug else '–í—ã–∫–ª—é—á–µ–Ω'}")
    print("=" * 60)
    
    # –ó–∞–ø—É—Å–∫ Flask —Å–µ—Ä–≤–µ—Ä–∞
    app.run(host=host, port=port, debug=debug)
